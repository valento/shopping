{"version":3,"sources":["../../server/routes/user.js"],"names":["userRouter","express","Router","mergeParams","db","database","route","get","getUserId","req","res","next","email","scope","findOne","then","status","json","user","catch","send","errors","global","err","message","post","checkAuth","body","rest","saveUser"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,aAAaC,kBAAQC,MAAR,CAAe;AAChCC,eAAa;AADmB,CAAf,CAAnB;AAGA;AACA,IAAMC,KAAK,IAAIC,cAAJ,CAAa,WAAb,CAAX;;AAEA;;AAEAL,WAAWM,KAAX,CAAiB,OAAjB,EACCC,GADD,CACKC,eADL,EACgB,UAACC,GAAD,EAAKC,GAAL,EAASC,IAAT,EAAkB;AAAA,MACxBC,KADwB,GACdH,GADc,CACxBG,KADwB;;AAEhC,MAAMC,QAAQ,CAAC,OAAD,EAAS,UAAT,EAAoB,QAApB,EAA6B,QAA7B,EAAsC,QAAtC,EAA+C,UAA/C,EAA0D,UAA1D,CAAd;AACAT,KAAGU,OAAH,CAAW,EAACF,YAAD,EAAX,EAAoB,OAApB,EAA6BC,KAA7B,EACCE,IADD,CACO,gBAAQ;AACbL,QAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,MAAMA,IAAP,EAArB;AACD,GAHD,EAICC,KAJD,CAIO,eAAO;AACZT,QAAIU,IAAJ,CAAS,GAAT,EAAcH,IAAd,CAAmB,EAACI,QAAQ,EAACC,QAAQC,IAAIC,OAAb,EAAT,EAAnB;AACD,GAND;AAOD,CAXD,EAYCC,IAZD,CAYMC,eAZN,EAYgB,UAACjB,GAAD,EAAKC,GAAL,EAASC,IAAT,EAAkB;AAChC;AADgC,MAExBO,IAFwB,GAEfT,IAAIkB,IAFW,CAExBT,IAFwB;;AAAA,MAGxBN,KAHwB,GAGNM,IAHM,CAGxBN,KAHwB;AAAA,MAGdgB,IAHc,4BAGNV,IAHM;;AAIhCd,KAAGyB,QAAH,CAAYD,IAAZ,EAAkBhB,KAAlB,EACCG,IADD,CACO,eAAO;AACZ,QAAIQ,GAAJ,EAAS;AACPb,UAAIU,IAAJ,CAAS,GAAT,EAAcH,IAAd,CAAmB,EAACI,QAAQ,EAACC,QAAQC,IAAIC,OAAb,EAAT,EAAnB;AACD,KAFD,MAEO;AACLd,UAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACO,SAAS,YAAV,EAArB;AACD;AACF,GAPD,EAQCL,KARD,CAQO,eAAO;AACZ;AACD,GAVD;AAWD,CA3BD;;kBA6BenB,U","file":"user.js","sourcesContent":["import express from 'express'\nimport database from '../api/user'\nimport { checkAuth, getUserId } from '../middleware/auth'\n\nconst userRouter = express.Router({\n  mergeParams: true\n})\n//userRouter.use()\nconst db = new database('./aapp.db')\n\n//userRouter.all('/data',checkAuth)\n\nuserRouter.route('/data')\n.get(getUserId, (req,res,next) => {\n  const { email } = req\n  const scope = ['email','username','credit','gender','rating','language','verified']\n  db.findOne({email}, 'users', scope)\n  .then( user => {\n    res.status(200).json({user: user})\n  })\n  .catch(err => {\n    res.send(500).json({errors: {global: err.message}})\n  })\n})\n.post(checkAuth,(req,res,next) => {\n  //const { email } = req.user\n  const { user } = req.body\n  const { email, ...rest} = user\n  db.saveUser(rest, email)\n  .then( err => {\n    if (err) {\n      res.send(500).json({errors: {global: err.message}})\n    } else {\n      res.status(200).json({message: 'Data saved'})\n    }\n  })\n  .catch(err => {\n    //\n  })\n})\n\nexport default userRouter\n"]}